{% extends "main/base.html" %}

{% block body %}

<div class="row">
	<div class="container card">
		<div class="card-body">
			<div class="card-header bg-white mb-2">
				<h4> Advanced search </h4>
			</div>

			{% if form.non_field_errors %}
				<div class="alert alert-danger alert-dismissible fade show" role="alert">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<h4> Oh no! </h4>
						<p> There were some errors with your submission </p>
						<hr>
						<p>{{ form.non_field_errors }}</p>
				</div>
			{% endif %}
			
			<form action="{% url 'search:search' %}" method="GET">
				{% for field in form %}
					<div class="form-group">
						<label for="{{ field.id_for_label }}">
							{{ field.label }}{% if field.field.required %}*{% endif %}
						</label>
						{% if field.errors %}
							<div class="alert alert-danger alert-dismissible fade show" role="alert">
								<button type="button" class="close" data-dismiss="alert" aria-label="Close">
									<span aria-hidden="true">&times;</span>
								</button>
								{{ field.errors }}
							</div>
						{% endif %}
						<br>
						{{ field }}
					</div>
				{% endfor %}
				<div class="card-footer bg-white">
					<input class="btn btn-outline-dark float-right" style="width: 150px;" 
								 type="submit" name="submit" value="Search">
				</div>
			</form>
		
		</div> <!-- End card body -->
	</div> <!-- End card -->
</div> <!-- end row -->

<div class="search-results table-container row mt-5">
	<table id="search_table" class="styled-table table table-hover">
		<thead>
			<tr>
				<th>Accesion</th>
				<th>Target</th>
				<th>Authors</th>
				<th>Target Organism</th>
				<th>Keywords</th>
				<th>External accessions</th>
			</tr>
		</thead>
		<tbody>
			{% for exp in experiments  %}
				<tr>
					<td>
						<a 
							href="{% url 'experiment:experiment_detail' exp.accession %}">
							{{ exp.accession }}
						</a>
					</td>
					<td>{{ exp.target }}</td>
					<td>{{ exp.get_authors }}</td>
					<td><em>{{ exp.get_target_organism|default:"-" }}</em></td>
					<td>{{ exp.get_keywords|default:"-" }}</td>
					<td>{{ exp.get_other_accessions|default:"-" }}</td>
				</tr>
			{% endfor %}
			
			{% for scs in scoresets  %}
			<tr>
				<td>
					<a 
						href="{% url 'scoreset:scoreset_detail' scs.accession %}">
						{{ scs.accession }}
					</a>
				</td>
				<td>{{ scs.experiment.target }}</td>
				<td>{{ scs.get_authors }}</td>
				<td><em>{{ scs.experiment.get_target_organism|default:"-" }}</em></td>
				<td>{{ scs.get_keywords|default:"-" }}</td>
				<td>{{ scs.experiment.get_other_accessions|default:"-" }}</td>
			</tr>
		{% endfor %}
		</tbody>
	</table>
</div>

{% endblock %}