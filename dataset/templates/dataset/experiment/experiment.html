{% extends "dataset/base/base.html" %}

{% block target %}
  <h2 id="targets" class="underline left-align section-heading"> Targets </h2>
  {% if instance.get_targets.count %}
    {% if instance.get_targets.count > 1%}
      <p class="text-muted">Multiple targets have been scored for this experiment: </p>
    {% else %}
      <p class="text-muted">A single target has been scored for this experiment: </p>
    {% endif %}
    {% for target in instance.get_targets.all %}
        <div class="target-card" onclick="goToUrl('{% url 'dataset:scoreset_detail' target.scoreset.urn %}')">
          <p>
            <strong>Target:</strong>
            <a href="/search/?target={{ target.get_name }}">
              {{ target.get_name }}
            </a>
          </p>

          <p>
            <strong>Species:</strong>
            <a href="/search/?species={{ target.get_reference_genomes.first.get_species_name }}">
              {{ target.get_reference_genomes.first.format_species_name_html|safe }}
            </a>
          </p>

          <p>
            <strong>Reference genome:</strong>
            <a href="/search/?genome={{ target.get_reference_genomes.first.get_short_name }}">
              {{ target.get_reference_genomes.first.get_short_name }}
            </a>
          </p>

          <p>
            <strong>Reference assembly:</strong>
            <a href={{ target.get_reference_genomes.first.genome_id.url }}>
              {{ target.get_reference_genomes.first.genome_id.identifier }}
            </a>
          </p>

          <p>
            <strong>Wildtype Sequence:</strong>
            {{ target.get_wt_sequence }}
          </p>

          {% if forloop.counter < instance.get_targets.count %}
            <hr>
          {% endif %}
        </div>
    {% endfor %}
  {% else %}
    <p class="text-muted">No targets have been scored for this experiment.</p>
  {% endif %}
{% endblock %}

{% block child_list %}
  <h2 id='scoresets' class="underline left-align section-heading">Score Sets</h2>
  {% if instance.children.count %}
    <ul>
      {% for child in instance.children %}
        {% if child.private %}
          {% if child in request.user.profile.contributor_scoresets %}
            <li class="child-list-item">
              <a style="display:block;" href="{% url 'dataset:scoreset_detail' child.urn %}">
                <p class="urn-item-link">{{ child.urn }} [Private]</p>
              </a>
              <p class="child-list-description"><b>{{ child.get_title }}</b></p>
              <p class="child-list-description">{{ child.get_description }}</p>
            </li>
          {% endif %}
        {% else %}
          <li class="child-list-item">
            <a style="display:block;" href="{% url 'dataset:scoreset_detail' child.urn %}">
              <p class="urn-item-link">{{ child.urn }}</p>
            </a>
            <p class="child-list-description"><b>{{ child.get_title }}</b></p>
            <p class="child-list-description">{{ child.get_description }}</p>
          </li>
        {% endif %}
      {% endfor %}
    </ul>
  {% else %}
    <p class="text-muted">No Score sets have been associated with this experiment.</p>
  {% endif %}
</div>
{% endblock %}

